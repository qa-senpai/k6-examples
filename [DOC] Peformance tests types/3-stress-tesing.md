## Стрес-тестування

Профіль навантаження в стрес-тесті схожий на тест із середнім навантаженням.

Основна відмінність – вищий рівень навантаження. Щоб врахувати цей фактор, період нарощування навантаження (ramp-up) триває довше пропорційно до його збільшення. Так само, після досягнення цільового навантаження, тест може виконуватись трохи довше, ніж у випадку тесту із середнім навантаженням.

### Коли виконувати стрес-тест

При виконанні стрес-тестування враховуйте наступне:
• Навантаження повинно бути вищим за середнє, яке система зазвичай витримує.

• Деякі тестувальники можуть мати стандартні цільові значення для стрес-тестів—наприклад, збільшення навантаження на 50% або 100% від середнього рівня. Однак фіксованого відсотка немає.

• Рівень навантаження в стрес-тесті визначається потенційно стресовими ситуаціями для системи. Іноді це може бути лише кілька відсотків понад середнє, в інших випадках—50–100% або навіть у кілька разів більше. У деяких сценаріях навантаження може бути вдвічі, втричі чи навіть на порядок вищим.
• Визначайте рівень навантаження відповідно до ризикових патернів, яким може піддаватись система.
• Стрес-тестування слід виконувати лише після тестів із середнім навантаженням.
• Спершу необхідно ідентифікувати проблеми продуктивності в тестах середнього навантаження, перш ніж переходити до більш складних випробувань. Дотримання цього порядку є критично важливим.
• Перевикористовуйте скрипти тестів із середнім навантаженням, змінюючи параметри для збільшення навантаження або кількості віртуальних користувачів (VUs).
• Очікуйте погіршення продуктивності порівняно із середнім навантаженням.
• Мета тесту – визначити, наскільки погіршується продуктивність при підвищеному навантаженні і чи витримує його система. Добре оптимізована система повинна зберігати стабільний час відповіді при постійному навантаженні протягом тривалого періоду.

## Стрес-тестування в k6

```javascript
import http from "k6/http";
import { sleep } from "k6";

export const options = {
  stages: [
    { duration: "10m", target: 200 }, // нарощування трафіку до 200 користувачів за 10 хвилин
    { duration: "30m", target: 200 }, // підтримання навантаження на 200 користувачів протягом 30 хвилин
    { duration: "5m", target: 0 }, // зниження навантаження до 0
  ],
};

export default () => {
  const urlRes = http.get("https://quickpizza.grafana.com");
  sleep(1);
};
```

### Аналіз результатів

Подібно до тесту із середнім навантаженням, первинні результати стрес-тесту проявляються вже під час періоду нарощування навантаження (ramp-up). Це дозволяє виявити деградацію часу відгуку у міру збільшення навантаження понад середній рівень. Зазвичай продуктивність погіршується, а при подальшому підвищенні навантаження можлива нестабільність або навіть аварійне завершення роботи системи.

Під час періоду повного навантаження важливо перевірити, чи залишається продуктивність і споживання ресурсів стабільними при підвищеному навантаженні.

Якщо система успішно витримує пікові навантаження, наступним кроком зазвичай є перевірка її продуктивності протягом тривалого часу. Для цього виконують Soak-тестування (тест на витривалість).
