### Spike-тестування

Spike-тестування перевіряє, чи витримує система раптові та масові стрибки навантаження, а також як вона працює в таких умовах.

Spike-тест особливо корисний для систем, які можуть стикатися з різкими сплесками трафіку, наприклад:
• Продаж квитків (концерти Taylor Swift)
• Запуск продуктів (PS5)
• Масові рекламні кампанії (Супербоул)
• Дедлайни важливих процесів (податкова звітність)
• Сезонні розпродажі (Black Friday)
• Щоденні пікові навантаження (години пік)

### Особливості spike-тестування

Spike-тестування передбачає швидке зростання навантаження до екстремально високого рівня без або з мінімальним періодом нарощування (ramp-up).

• Період пікового навантаження зазвичай відсутній або дуже короткий, оскільки реальні користувачі в таких ситуаціях не затримуються для додаткових дій.

• Ramp-down (зниження навантаження) також відбувається миттєво або не використовується зовсім, дозволяючи протестувати лише один цикл навантаження.

• Spike-тест може включати інші процеси, ніж попередні типи тестів, оскільки різкі сплески трафіку зазвичай не є типовими для середнього робочого дня.

• Модифікація, додавання або видалення процесів у тестовому сценарії може бути необхідною, щоб адаптувати тест під характерні сценарії стрибків навантаження.

Іноді команда повинна змінювати архітектуру системи для ефективного перерозподілу ресурсів під час пікових навантажень.

⸻

### Огляд spike-тесту

Коли виконувати spike-тест

Spike-тест необхідно виконувати, коли система очікує різке зростання активності.
• Тестування дозволяє виявити потенційні проблеми продуктивності та визначити, чи зможе система витримати сплеск навантаження.
• Навантаження значно перевищує середнє і може фокусуватися на інших процесах, ніж у попередніх тестах.

⸻

Що враховувати при підготовці до spike-тесту

✅ Фокусуйтесь на критичних процесах
• Оцініть, чи сплеск навантаження використовує ті самі або інші процеси, ніж у попередніх тестах.
• Відповідно адаптуйте тестову логіку.

❌ Тест може не завершитися повністю
• Помилки в таких сценаріях є нормальними та очікуваними.

🔄 Запускайте, налаштовуйте, повторюйте
• Якщо система піддається ризику різких сплесків навантаження, тестування та оптимізація повинні проводитися кілька разів.

📊 Моніторинг бекенду є обов’язковим
• Успішне spike-тестування неможливе без ретельного моніторингу бекенду.
• Слідкуйте за навантаженням на ресурси, ефективністю запитів та можливими вузькими місцями.

```
import http from 'k6/http';
import { sleep } from 'k6';

export const options = {
  // Key configurations for spike in this section
  stages: [
    { duration: '2m', target: 2000 }, // fast ramp-up to a high point
    // No plateau
    { duration: '1m', target: 0 }, // quick ramp-down to 0 users
  ],
};

export default () => {
  const urlRes = http.get('https://quickpizza.grafana.com');
  sleep(1);
  // MORE STEPS
  // Add only the processes that will be on high demand
  // Step1
  // Step2
  // etc.
};
```
